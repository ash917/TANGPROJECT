<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.my.tang.dao.auction.ProductMapper">

    <insert id="insert" parameterType="ProductDto" >
        INSERT INTO product
        (m_id, p_title, p_ca, p_sprice, p_eprice, p_sdate, p_date, p_rdate, p_img1, p_img2, p_img3, p_img4, p_img5, p_detail, a_price)
        VALUES
            (#{m_id}, #{p_title}, #{p_ca}, #{p_sprice}, #{p_eprice}, now(), #{p_date}, #{p_rdate}, #{p_img1}, #{p_img2}, #{p_img3}, #{p_img4}, #{p_img5}, #{p_detail}, #{a_price})
    </insert>

    <select id="count" resultType="int">
        SELECT count(*) FROM product
    </select>

    <sql id="selectFromBoard">
        SELECT *
        FROM product
    </sql>

    <select id="selectPage" parameterType="map" resultType="ProductDto">
        <include refid="selectFromBoard"/>
        ORDER BY p_num DESC
        LIMIT #{offset}, #{pageSize}
    </select>

    <select id="select" parameterType="int" resultType="ProductDto">
        <include refid="selectFromBoard"/>
        WHERE p_num = #{p_num}
    </select>

    <delete id="deleteAll">
        DELETE FROM product
    </delete>

    <delete id="delete" parameterType="map">
        DELETE FROM product WHERE p_num = #{p_num} and m_id = #{m_id}
    </delete>

    <update id="update" parameterType="ProductDto">
        UPDATE product
        SET   p_title = #{p_title}
          , p_detail = #{p_detail}
          , p_date = now()
        WHERE p_num = #{p_num} and m_id = #{m_id}
    </update>


</mapper>